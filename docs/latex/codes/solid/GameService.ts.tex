\begin{lstlisting}[language=JavaScript, caption={Implementação que viola o SRP},captionpos=b, label=alg:gameservice]
import AppError from '@shared/errors/AppError';
import log from '@shared/utils/log';
import { injectable, inject } from 'tsyringe';
import Game from '../infra/typeorm/entities/Game';

import IGamesRepository from '../repositories/IGamesRepository';

interface IRequest {
  game_id: string;
}

@injectable()
export default class GameService {
  constructor(
    @inject('GamesRepository')
    private gamesRepository: IGamesRepository,
  ) {}

  public async showGame({ game_id }: IRequest): Promise<Game> {
    log.debug(`Show Game :: id: ${game_id}`);
    const game = await this.gamesRepository.findById(game_id);
    if (!game) {
      throw new AppError('Game not found', 404);
    }
    return game;
  }

  public async createGame({
      name,
      price,
      publisher,
      release_date,
    }: ICreateGameDTO): Promise<Game> {
      log.debug(
        'Create Game :: ',
        JSON.stringify({ name, price, publisher, release_date }),
      );
      const checkGame =
        await this.gamesRepository.findByNameAndPublisherAndReleaseDate({
          name,
          publisher,
          release_date,
        });
      if (checkGame) {
        throw new AppError('Game Already registered');
      }
      const game = await this.gamesRepository.create({
        name,
        price,
        publisher,
        release_date,
      });
  
      return game;
    }

  public async updateGame({
    game_id,
    price,
    release_date,
  }: IRequest): Promise<Game> {
    log.debug('Update Game', JSON.stringify({ game_id, price, release_date }));
    const game = await this.gamesRepository.findById(game_id);
    if (!game) {
      throw new AppError('Game not found', 404);
    }
    if (price) {
      if (price < 0) {
        throw new AppError("Price can't be lesser than 0");
      }
      Object.assign(game, { price });
    }
    if (release_date) {
      const now = Date.now();
      if (game.release_date.getTime() < now) {
        throw new AppError("Can't update if game is already release");
      }

      if (now > new Date(release_date).getTime()) {
        throw new AppError("New Release Date can't be in the past", 400);
      }

      Object.assign(game, { release_date });
    }
    return this.gamesRepository.save(game);
  }
}
\end{lstlisting}